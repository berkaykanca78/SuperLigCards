<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trendyol Süper Lig Fikstürü</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='45' fill='%23E60012' stroke='%23FFFFFF' stroke-width='3'/><polygon points='50,20 60,35 75,35 65,50 70,65 50,55 30,65 35,50 25,35 40,35' fill='%23FFFFFF'/></svg>"
        type="image/svg+xml">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="assets/css/index.css">
    <link rel="stylesheet" href="assets/css/fixture.css">
</head>

<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-container">
            <a href="index.html" class="navbar-brand">
                <span>Trendyol Süper Lig</span>
            </a>
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a href="index.html" class="nav-link">Home</a>
                </li>
                <li class="nav-item">
                    <a href="lineup.html" class="nav-link">Lineup</a>
                </li>
                <li class="nav-item">
                    <a href="fixture.html" class="nav-link active">Fixture</a>
                </li>
            </ul>
        </div>
    </nav>

    <button class="menu-toggle">☰</button>
    <div class="container">
        <div class="sidebar">
            <div class="league-header">
                <img src="https://www.tff.org/Resources/TFF/Images/0000000015/TFF/TFF-Logolar/2024-2025/trendyol-super-lig-dikey-logo.png"
                    alt="Trendyol Süper Lig" class="league-logo">
                <h1>TRENDYOL SÜPER LİG</h1>
            </div>
            <ul class="teams-list">
                <!-- Teams will be dynamically loaded here -->
            </ul>
        </div>

        <div class="main-content">
            <div class="fixture-container">
                <div class="fixture-header">
                    <h1>2025-2026 Süper Lig Fikstürü</h1>
                    <p>38 haftalık sezon programı</p>
                </div>

                <div class="season-info">
                    <p>Sezon: 2025-2026 | Toplam Hafta: 38 | Toplam Maç: 342</p>
                </div>

                <div class="navigation-buttons">
                    <button class="nav-button" id="prevWeek" disabled>
                        <i class="fas fa-chevron-left"></i>
                        Önceki Hafta
                    </button>
                    <button class="nav-button" id="nextWeek">
                        Sonraki Hafta
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>

                <div class="week-selector" id="weekSelector">
                    <!-- Week buttons will be generated here -->
                </div>

                <div id="fixtureGrid" class="fixture-grid">
                    <div class="loading">
                        <i class="fas fa-spinner fa-spin"></i>
                        Fikstür yükleniyor...
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="assets/js/index.js" defer></script>
    <script src="assets/js/leagueTeamGenerator.js" defer></script>
    <script>
        // Turkish Süper Lig teams from JSON data
        let teams = [];

        // Stadiums
        const stadiums = [
            "NEF Arena", "Ülker Stadyumu", "Vodafone Park", "Şenol Güneş Spor Kompleksi",
            "Başakşehir Fatih Terim Stadyumu", "Antalya Stadyumu", "Konya Büyükşehir Belediye Stadyumu",
            "Bahçeşehir Okulları Stadyumu", "Kadir Has Şehir Stadyumu", "Gaziantep Stadyumu",
            "Kocaeli Stadyumu", "Ankara 19 Mayıs Stadyumu", "Vefa Stadyumu", "Recep Tayyip Erdoğan Stadyumu",
            "Çotanak Spor Kompleksi", "Gürsel Aksel Stadyumu", "19 Mayıs Stadyumu", "Eyüp Stadyumu"
        ];

        let currentWeek = 1;
        const totalWeeks = 38;
        let fixtureData = [];

        // Override team button functionality for fixture page
        function attachFixtureTeamButtonListeners() {
            document.querySelectorAll('.team-button').forEach(button => {
                button.addEventListener('click', function () {
                    // Remove active class from all buttons
                    document.querySelectorAll('.team-button').forEach(btn => {
                        btn.classList.remove('active');
                    });

                    // Add active class to clicked button
                    this.classList.add('active');

                    // For fixture page, we don't need to load team cards
                    // Just keep the fixture content visible
                    console.log('Team selected:', this.dataset.team);
                });
            });

            // Select Galatasaray by default
            const galatasarayButton = document.querySelector('[data-team="galatasaray"]');
            if (galatasarayButton) {
                galatasarayButton.click();
            }
        }

        // Override the default attachTeamButtonListeners for fixture page
        window.attachTeamButtonListeners = attachFixtureTeamButtonListeners;

        // Load teams from JSON and generate fixture
        async function loadTeamsAndGenerateFixture() {
            try {
                const response = await fetch('assets/data/teams.json');
                const data = await response.json();
                teams = data.teams;

                // Generate fixture data
                fixtureData = generateFixture();

                // Initialize the page
                generateWeekSelector();
                showWeek(1);

            } catch (error) {
                console.error('Error loading teams:', error);
                document.getElementById('fixtureGrid').innerHTML =
                    '<div class="no-matches">Takım verileri yüklenirken hata oluştu.</div>';
            }
        }

        // Generate fixture data
        function generateFixture() {
            const fixture = [];

            // Generate all weeks
            for (let week = 1; week <= totalWeeks; week++) {
                const weekMatches = [];
                const usedTeams = new Set();

                // Generate 9 matches per week (18 teams)
                for (let match = 1; match <= 9; match++) {
                    let homeTeam, awayTeam;

                    do {
                        homeTeam = Math.floor(Math.random() * teams.length);
                        awayTeam = Math.floor(Math.random() * teams.length);
                    } while (homeTeam === awayTeam ||
                    usedTeams.has(homeTeam) ||
                        usedTeams.has(awayTeam));

                    usedTeams.add(homeTeam);
                    usedTeams.add(awayTeam);

                    // Generate random date for the week
                    const weekStartDate = new Date(2024, 7, 18); // August 18, 2024
                    const matchDate = new Date(weekStartDate);
                    matchDate.setDate(weekStartDate.getDate() + (week - 1) * 7 + Math.floor(Math.random() * 7));

                    weekMatches.push({
                        week: week,
                        matchNumber: match,
                        homeTeam: teams[homeTeam],
                        awayTeam: teams[awayTeam],
                        date: matchDate,
                        time: `${Math.floor(Math.random() * 3) + 19}:${Math.random() > 0.5 ? '00' : '30'}`,
                        stadium: stadiums[Math.floor(Math.random() * stadiums.length)]
                    });
                }

                fixture.push(weekMatches);
            }

            return fixture;
        }

        // Generate week selector buttons
        function generateWeekSelector() {
            const weekSelector = document.getElementById('weekSelector');
            weekSelector.innerHTML = '';

            for (let week = 1; week <= totalWeeks; week++) {
                const button = document.createElement('button');
                button.className = 'week-button';
                button.textContent = week;
                button.onclick = () => showWeek(week);
                weekSelector.appendChild(button);
            }
        }

        // Show matches for a specific week
        function showWeek(week) {
            currentWeek = week;

            // Update active week button
            document.querySelectorAll('.week-button').forEach((btn, index) => {
                btn.classList.toggle('active', index + 1 === week);
            });

            // Update navigation buttons
            document.getElementById('prevWeek').disabled = week === 1;
            document.getElementById('nextWeek').disabled = week === totalWeeks;

            // Display matches
            displayMatches(fixtureData[week - 1]);
        }

        // Display matches
        function displayMatches(matches) {
            const fixtureGrid = document.getElementById('fixtureGrid');

            if (!matches || matches.length === 0) {
                fixtureGrid.innerHTML = '<div class="no-matches">Bu hafta için maç bulunamadı.</div>';
                return;
            }

            fixtureGrid.innerHTML = matches.map(match => `
                <div class="match-card">
                    <div class="match-header">
                        <span class="match-number">Maç ${match.matchNumber}</span>
                        <span class="match-date">${match.date.toLocaleDateString('tr-TR', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            })}</span>
                    </div>
                    
                    <div class="teams-container">
                        <div class="team home">
                            <img src="${match.homeTeam.logo}" alt="${match.homeTeam.name}" class="team-logo">
                            <div class="team-name">${match.homeTeam.name}</div>
                        </div>
                        
                        <div class="vs">VS</div>
                        
                        <div class="team away">
                            <img src="${match.awayTeam.logo}" alt="${match.awayTeam.name}" class="team-logo">
                            <div class="team-name">${match.awayTeam.name}</div>
                        </div>
                    </div>
                    
                    <div class="match-info">
                        <div class="stadium">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>${match.stadium}</span>
                        </div>
                        <div class="time">
                            <i class="fas fa-clock"></i>
                            <span>${match.time}</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Navigation event listeners
        document.getElementById('prevWeek').addEventListener('click', () => {
            if (currentWeek > 1) {
                showWeek(currentWeek - 1);
            }
        });

        document.getElementById('nextWeek').addEventListener('click', () => {
            if (currentWeek < totalWeeks) {
                showWeek(currentWeek + 1);
            }
        });

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            loadTeamsAndGenerateFixture();
        });
    </script>
</body>

</html>